<div class="recipe-generator-container">
  <div class="generator-header">
    <h1>{{ 'RECIPE_GENERATOR.TITLE' | translate }}</h1>
    <p>{{ 'RECIPE_GENERATOR.DESCRIPTION' | translate }}</p>
    
    <!-- User usage status -->
    <div *ngIf="userUsage" class="usage-status">
      <div class="usage-info" [class.premium]="userUsage.PlanStatus === 'Premium'">
        <span class="plan-badge">{{ userUsage.PlanStatus }}</span>
        <span class="usage-count">{{ userUsage.RemainingRecipes }} {{ 'RECIPE_GENERATOR.RECIPES_REMAINING' | translate }}</span>
        <button *ngIf="userUsage.PlanStatus === 'Free'" class="upgrade-btn" (click)="goToUpgrade()">
          {{ 'RECIPE_GENERATOR.UPGRADE_PREMIUM' | translate }}
        </button>
      </div>
    </div>
  </div>

  <!-- Complexity Slider -->
  <app-complexity-slider 
    [value]="recipeRequest.ComplexityLevel"
    (valueChange)="onComplexityChange($event)">
  </app-complexity-slider>



  <!-- Recipe Configuration Form -->
  <div class="recipe-form-container">
    <h3>{{ 'RECIPE_GENERATOR.FORM_TITLE' | translate }}</h3>
    
    <div class="form-row">
      <div class="form-group">
        <label for="numberOfDiners">{{ 'RECIPE_GENERATOR.NUMBER_OF_DINERS' | translate }}</label>
        <input 
          type="number" 
          id="numberOfDiners"
          [(ngModel)]="recipeRequest.NumberOfDiners"
          min="1" 
          max="20"
          class="form-input number-input"
        />
      </div>

      <div class="form-group">
        <label for="dinerAges">{{ 'RECIPE_GENERATOR.AGE_GROUPS' | translate }}</label>
        <select 
          id="dinerAges"
          [(ngModel)]="recipeRequest.DinerAges"
          class="form-input"
        >
          <option value="">{{ 'RECIPE_GENERATOR.SELECT_AGE_GROUPS' | translate }}</option>
          <option *ngFor="let option of dinerAgeOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="cookingMethod">{{ 'RECIPE_GENERATOR.COOKING_METHOD' | translate }}</label>
        <select 
          id="cookingMethod"
          [(ngModel)]="recipeRequest.CookingMethod"
          class="form-input"
          required
        >
          <option value="">{{ 'RECIPE_GENERATOR.CHOOSE_COOKING_METHOD' | translate }}</option>
          <option *ngFor="let method of cookingMethods" [value]="method.value">
            {{ method.label }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="cookingTime">{{ 'RECIPE_GENERATOR.COOKING_TIME' | translate }}</label>
        <select 
          id="cookingTime"
          [(ngModel)]="recipeRequest.CookingTimeMinutes"
          class="form-input"
        >
          <option *ngFor="let time of cookingTimes" [value]="time.value">
            {{ time.label }}
          </option>
        </select>
      </div>
    </div>

    <div class="form-group">
      <label for="dietaryRestrictions">{{ 'RECIPE_GENERATOR.DIETARY_PREFERENCES' | translate }}</label>
      <select 
        id="dietaryRestrictions"
        [(ngModel)]="recipeRequest.DietaryRestrictions"
        class="form-input"
      >
        <option value="">{{ 'RECIPE_GENERATOR.NO_DIETARY_RESTRICTIONS' | translate }}</option>
        <option *ngFor="let option of dietaryOptions" [value]="option.value">
          {{ option.label }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="userPrompt">{{ 'RECIPE_GENERATOR.SPECIAL_REQUESTS' | translate }}</label>
      <textarea 
        id="userPrompt"
        [(ngModel)]="recipeRequest.UserPrompt"
        [placeholder]="'RECIPE_GENERATOR.SPECIAL_REQUESTS_PLACEHOLDER' | translate"
        class="form-input textarea-input"
        rows="3"
      ></textarea>
      <small class="input-help">
        {{ 'RECIPE_GENERATOR.SPECIAL_REQUESTS_HELP' | translate }}
      </small>
    </div>

    <!-- Error message -->
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <!-- Generate button -->
    <div class="generate-section">
      <button 
        class="generate-btn"
        [disabled]="!canGenerate()"
        (click)="onGenerate()"
      >
        <span *ngIf="!isGenerating">{{ 'RECIPE_GENERATOR.GENERATE_BUTTON' | translate }}</span>
        <span *ngIf="isGenerating">
          <div class="spinner"></div>
          {{ 'RECIPE_GENERATOR.GENERATING' | translate }}
        </span>
      </button>

      <div *ngIf="!userUsage?.CanGenerateMore && userUsage" class="limit-message">
        <p>{{ 'RECIPE_GENERATOR.DAILY_LIMIT_REACHED' | translate }} <a href="#" (click)="goToUpgrade()">{{ 'RECIPE_GENERATOR.UPGRADE_LINK' | translate }}</a> for 30 recipes per day!</p>
      </div>

      <div *ngIf="!canGenerate() && userUsage?.CanGenerateMore" class="form-validation">
        <p>{{ 'RECIPE_GENERATOR.SELECT_COOKING_METHOD_MSG' | translate }}</p>
      </div>
    </div>
  </div>

    <!-- AI Cut Selection Info -->
  <div class="recipe-form-container">
    <h3>{{ 'RECIPE_GENERATOR.AI_CUT_SELECTION_TITLE' | translate }}</h3>
    <p style="color: var(--text-secondary); text-align: center; margin: 0; line-height: 1.6;">
      {{ 'RECIPE_GENERATOR.AI_CUT_SELECTION_DESCRIPTION' | translate }}<br>
      <small><em>{{ 'RECIPE_GENERATOR.AI_CUT_SELECTION_NOTE' | translate }}</em></small>
    </p>
  </div>

  <!-- Recipe preview -->
  <div *ngIf="recipeRequest.CookingMethod" class="recipe-preview">
    <h4>{{ 'RECIPE_GENERATOR.PREVIEW_TITLE' | translate }}</h4>
    <div class="preview-content">
      <div class="preview-item">
        <strong>{{ 'RECIPE_GENERATOR.BEEF_CUT' | translate }}</strong> <em>{{ 'RECIPE_GENERATOR.AI_SUGGEST' | translate }}</em>
      </div>
      <div class="preview-item">
        <strong>{{ 'RECIPE_GENERATOR.SKILL_LEVEL' | translate }}</strong> 
        <span class="complexity-indicator">
          {{ recipeRequest.ComplexityLevel }}/5 
          <span *ngFor="let i of [1,2,3,4,5]" [class]="i <= recipeRequest.ComplexityLevel ? 'star-filled' : 'star-empty'">â˜…</span>
        </span>
      </div>
      <div class="preview-item">
        <strong>{{ 'RECIPE_GENERATOR.SERVES' | translate }}</strong> <span>{{ recipeRequest.NumberOfDiners }} {{ 'RECIPE_GENERATOR.SERVES_VALUE' | translate }}</span>
      </div>
      <div class="preview-item">
        <strong>{{ 'RECIPE_GENERATOR.METHOD' | translate }}</strong> {{ recipeRequest.CookingMethod }}
      </div>
      <div class="preview-item">
        <strong>{{ 'RECIPE_GENERATOR.TIME' | translate }}</strong> <span>{{ recipeRequest.CookingTimeMinutes }} {{ 'RECIPE_GENERATOR.TIME_VALUE' | translate }}</span>
      </div>
    </div>
  </div>
</div>